<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจองรถ | Car Rental System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #3a86ff;
            --primary-dark: #2667cc;
            --secondary: #ff006e;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --success: #38b000;
            --warning: #ffbe0b;
            --danger: #e63946;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Noto Sans Thai', sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 2rem 0;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 20px rgba(58, 134, 255, 0.2);
            margin-bottom: 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo i {
            font-size: 2.5rem;
        }
        
        .logo h1 {
            font-size: 2.2rem;
            font-weight: 700;
        }
        
        .logo p {
            font-size: 1rem;
            opacity: 0.9;
        }
        
        .stats {
            display: flex;
            gap: 20px;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.15);
            padding: 15px 25px;
            border-radius: 12px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        /* Form Section */
        .form-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--primary);
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .section-title i {
            background: var(--primary);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e1e5ee;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: white;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(58, 134, 255, 0.1);
        }
        
        .submit-btn {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(58, 134, 255, 0.3);
        }
        
        /* Reservations Section */
        .reservations-section {
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .filter-btn {
            padding: 10px 20px;
            border-radius: 10px;
            border: 2px solid #e1e5ee;
            background: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .reservations-list {
            max-height: 600px;
            overflow-y: auto;
        }
        
        .reservation-card {
            border-left: 5px solid var(--primary);
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 12px;
            background: #f8fafc;
            transition: all 0.3s;
        }
        
        .reservation-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .reservation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .reservation-code {
            background: var(--primary);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .reservation-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }
        
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        
        .status-upcoming {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-completed {
            background: #f8f9fa;
            color: var(--gray);
        }
        
        .reservation-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .detail-item {
            margin-bottom: 10px;
        }
        
        .detail-label {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 3px;
        }
        
        .detail-value {
            font-weight: 600;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 25px 0;
            color: var(--gray);
            border-top: 1px solid #e1e5ee;
            margin-top: 40px;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .header-content {
                flex-direction: column;
                gap: 25px;
                text-align: center;
            }
            
            .stats {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .reservation-details {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-wrap: wrap;
            }
            
            .stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-car"></i>
                    <div>
                        <h1>ระบบจองรถยนต์</h1>
                        <p>Car Rental Management System</p>
                    </div>
                </div>
                <div class="stats">
                    <div class="stat-box">
                        <div class="stat-value" id="total-reservations">12</div>
                        <div class="stat-label">การจองทั้งหมด</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="active-reservations">3</div>
                        <div class="stat-label">กำลังดำเนินการ</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="available-cars">7</div>
                        <div class="stat-label">รถว่าง</div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="main-layout">
            <!-- Form Section -->
            <section class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-file-alt"></i>
                    แบบฟอร์มจองรถยนต์
                </h2>
                
                <form id="reservationForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name"><i class="fas fa-user"></i> ชื่อ-นามสกุล *</label>
                            <input type="text" id="name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="code"><i class="fas fa-id-card"></i> รหัสพนักงาน *</label>
                            <input type="text" id="code" name="code" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="section"><i class="fas fa-building"></i> แผนก *</label>
                            <select id="section" name="section" required>
                                <option value="">เลือกแผนก</option>
                                <option value="บริหาร">บริหาร</option>
                                <option value="การเงิน">การเงิน</option>
                                <option value="ทรัพยากรบุคคล">ทรัพยากรบุคคล</option>
                                <option value="ไอที">ไอที</option>
                                <option value="ฝ่ายขาย">ฝ่ายขาย</option>
                                <option value="ฝ่ายการตลาด">ฝ่ายการตลาด</option>
                                <option value="ฝ่ายผลิต">ฝ่ายผลิต</option>
                                <option value="ฝ่ายจัดซื้อ">ฝ่ายจัดซื้อ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="department"><i class="fas fa-sitemap"></i> ฝ่าย *</label>
                            <input type="text" id="department" name="department" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="position"><i class="fas fa-briefcase"></i> ตำแหน่ง *</label>
                            <input type="text" id="position" name="position" required>
                        </div>
                        <div class="form-group">
                            <label for="contact"><i class="fas fa-phone"></i> เบอร์ติดต่อ *</label>
                            <input type="tel" id="contact" name="contact" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="choose"><i class="fas fa-car"></i> ประเภทรถที่ต้องการ *</label>
                        <select id="choose" name="choose" required>
                            <option value="">เลือกรถยนต์</option>
                            <option value="รถยนต์นั่งส่วนบุคคล">รถยนต์นั่งส่วนบุคคล</option>
                            <option value="รถยนต์กระบะ">รถยนต์กระบะ</option>
                            <option value="รถตู้">รถตู้</option>
                            <option value="รถบัส">รถบัส</option>
                        </select>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rentStartdate"><i class="fas fa-calendar-alt"></i> วันที่เริ่มจอง *</label>
                            <input type="date" id="rentStartdate" name="rentStartdate" required>
                        </div>
                        <div class="form-group">
                            <label for="rentEnddate"><i class="fas fa-calendar-alt"></i> วันที่สิ้นสุดจอง *</label>
                            <input type="date" id="rentEnddate" name="rentEnddate" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="startTime"><i class="fas fa-clock"></i> เวลาเริ่มต้น *</label>
                            <input type="time" id="startTime" name="startTime" required>
                        </div>
                        <div class="form-group">
                            <label for="endTime"><i class="fas fa-clock"></i> เวลาสิ้นสุด *</label>
                            <input type="time" id="endTime" name="endTime" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="reason"><i class="fas fa-file-signature"></i> วัตถุประสงค์ในการใช้รถ *</label>
                        <textarea id="reason" name="reason" rows="3" required></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> ส่งคำขอจองรถ
                    </button>
                </form>
            </section>
            
            <!-- Reservations Section -->
            <section class="reservations-section">
                <h2 class="section-title">
                    <i class="fas fa-list-alt"></i>
                    รายการจองรถยนต์
                </h2>
                
                <div class="filters">
                    <button class="filter-btn active" data-filter="all">ทั้งหมด</button>
                    <button class="filter-btn" data-filter="active">กำลังดำเนินการ</button>
                    <button class="filter-btn" data-filter="upcoming">กำลังจะมาถึง</button>
                    <button class="filter-btn" data-filter="completed">เสร็จสิ้น</button>
                </div>
                
                <div class="reservations-list" id="reservationsList">
                    <!-- Reservation cards will be loaded here -->
                    <div class="reservation-card">
                        <div class="reservation-header">
                            <div class="reservation-code">RES-001</div>
                            <div class="reservation-status status-active">กำลังดำเนินการ</div>
                        </div>
                        <div class="reservation-details">
                            <div class="detail-item">
                                <div class="detail-label">ผู้จอง</div>
                                <div class="detail-value">สมชาย ใจดี</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">แผนก/ฝ่าย</div>
                                <div class="detail-value">ฝ่ายขาย / การตลาด</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">ประเภทรถ</div>
                                <div class="detail-value">รถยนต์นั่งส่วนบุคคล</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">วันที่จอง</div>
                                <div class="detail-value">15 มิ.ย. 2566 - 17 มิ.ย. 2566</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">เวลา</div>
                                <div class="detail-value">09:00 - 17:00</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">วัตถุประสงค์</div>
                                <div class="detail-value">นำทีมงานไปพบลูกค้าที่จังหวัดชลบุรี</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- More cards will be added dynamically -->
                </div>
            </section>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>ระบบจองรถยนต์ | Car Rental Management System</p>
            <p>© 2023 บริษัท ตัวอย่าง จำกัด. All rights reserved.</p>
        </div>
    </footer>
    
    <script>
        // Sample data for demonstration
        const sampleReservations = [
            {
                code: "RES-001",
                name: "สมชาย ใจดี",
                section: "ฝ่ายขาย",
                department: "การตลาด",
                position: "ผู้จัดการฝ่าย",
                contact: "081-234-5678",
                choose: "รถยนต์นั่งส่วนบุคคล",
                rentStartdate: "2023-06-15",
                rentEnddate: "2023-06-17",
                startTime: "09:00",
                endTime: "17:00",
                reason: "นำทีมงานไปพบลูกค้าที่จังหวัดชลบุรี",
                status: "active"
            },
            {
                code: "RES-002",
                name: "สุนิตา รักงาน",
                section: "บริหาร",
                department: "ผู้บริหาร",
                position: "ผู้จัดการทั่วไป",
                contact: "082-345-6789",
                choose: "รถตู้",
                rentStartdate: "2023-06-20",
                rentEnddate: "2023-06-20",
                startTime: "08:00",
                endTime: "16:00",
                reason: "พาพนักงานไปอบรมสัมมนาที่โรงแรม",
                status: "upcoming"
            },
            {
                code: "RES-003",
                name: "ประเสริฐ ทำงานดี",
                section: "ไอที",
                department: "พัฒนาซอฟต์แวร์",
                position: "โปรแกรมเมอร์",
                contact: "083-456-7890",
                choose: "รถยนต์นั่งส่วนบุคคล",
                rentStartdate: "2023-06-10",
                rentEnddate: "2023-06-10",
                startTime: "10:00",
                endTime: "15:00",
                reason: "ไปซื้ออุปกรณ์คอมพิวเตอร์ที่ตลาด",
                status: "completed"
            }
        ];
        
        // Initialize with sample data
        let reservations = [...sampleReservations];
        
        // DOM elements
        const form = document.getElementById('reservationForm');
        const reservationsList = document.getElementById('reservationsList');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const totalReservations = document.getElementById('total-reservations');
        const activeReservations = document.getElementById('active-reservations');
        
        // Format date to Thai format
        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = { day: 'numeric', month: 'short', year: 'numeric' };
            const thaiYear = date.getFullYear() + 543;
            return `${date.getDate()} ${date.toLocaleDateString('th-TH', { month: 'short' })} ${thaiYear}`;
        }
        
        // Generate reservation code
        function generateReservationCode() {
            const count = reservations.length + 1;
            return `RES-${count.toString().padStart(3, '0')}`;
        }
        
        // Update statistics
        function updateStatistics() {
            totalReservations.textContent = reservations.length;
            const activeCount = reservations.filter(r => r.status === 'active').length;
            activeReservations.textContent = activeCount;
        }
        
        // Create reservation card HTML
        function createReservationCard(reservation) {
            let statusClass = 'status-active';
            let statusText = 'กำลังดำเนินการ';
            
            if (reservation.status === 'upcoming') {
                statusClass = 'status-upcoming';
                statusText = 'กำลังจะมาถึง';
            } else if (reservation.status === 'completed') {
                statusClass = 'status-completed';
                statusText = 'เสร็จสิ้น';
            }
            
            return `
                <div class="reservation-card" data-status="${reservation.status}">
                    <div class="reservation-header">
                        <div class="reservation-code">${reservation.code}</div>
                        <div class="reservation-status ${statusClass}">${statusText}</div>
                    </div>
                    <div class="reservation-details">
                        <div class="detail-item">
                            <div class="detail-label">ผู้จอง</div>
                            <div class="detail-value">${reservation.name}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">แผนก/ฝ่าย</div>
                            <div class="detail-value">${reservation.section} / ${reservation.department}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ตำแหน่ง</div>
                            <div class="detail-value">${reservation.position}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ติดต่อ</div>
                            <div class="detail-value">${reservation.contact}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ประเภทรถ</div>
                            <div class="detail-value">${reservation.choose}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">วันที่จอง</div>
                            <div class="detail-value">${formatDate(reservation.rentStartdate)} - ${formatDate(reservation.rentEnddate)}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">เวลา</div>
                            <div class="detail-value">${reservation.startTime} - ${reservation.endTime}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">วัตถุประสงค์</div>
                            <div class="detail-value">${reservation.reason}</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        // Render reservations
        function renderReservations(filter = 'all') {
            reservationsList.innerHTML = '';
            
            const filteredReservations = filter === 'all' 
                ? reservations 
                : reservations.filter(r => r.status === filter);
            
            if (filteredReservations.length === 0) {
                reservationsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--gray);">
                        <i class="fas fa-car" style="font-size: 3rem; margin-bottom: 15px;"></i>
                        <h3>ไม่พบรายการจอง</h3>
                        <p>${filter === 'all' ? 'ยังไม่มีรายการจองรถยนต์' : 'ไม่พบรายการจองในประเภทนี้'}</p>
                    </div>
                `;
                return;
            }
            
            filteredReservations.forEach(reservation => {
                reservationsList.innerHTML += createReservationCard(reservation);
            });
        }
        
        // Form submission
        form.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const formData = {
                code: generateReservationCode(),
                name: document.getElementById('name').value,
                section: document.getElementById('section').value,
                department: document.getElementById('department').value,
                position: document.getElementById('position').value,
                contact: document.getElementById('contact').value,
                choose: document.getElementById('choose').value,
                rentStartdate: document.getElementById('rentStartdate').value,
                rentEnddate: document.getElementById('rentEnddate').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                reason: document.getElementById('reason').value,
                status: 'upcoming'
            };
            
            // Add to reservations array
            reservations.unshift(formData);
            
            // Update UI
            renderReservations('all');
            updateStatistics();
            
            // Reset form
            form.reset();
            
            // Update active filter button
            filterButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-filter="all"]').classList.add('active');
            
            // Show success message
            alert('บันทึกข้อมูลการจองรถเรียบร้อยแล้ว! รหัสการจอง: ' + formData.code);
            
            // In a real implementation, you would send data to Google Apps Script here
            // sendToGoogleAppsScript(formData);
        });
        
        // Filter functionality
        filterButtons.forEach(button => {
            button.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                
                // Update active button
                filterButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Render filtered reservations
                renderReservations(filter);
            });
        });
        
        // Initialize date inputs with today and tomorrow
        const today = new Date();
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        document.getElementById('rentStartdate').valueAsDate = today;
        document.getElementById('rentEnddate').valueAsDate = tomorrow;
        document.getElementById('startTime').value = '09:00';
        document.getElementById('endTime').value = '17:00';
        
        // Initial render
        renderReservations('all');
        updateStatistics();
        
        // Function to send data to Google Apps Script (for actual implementation)
        function sendToGoogleAppsScript(formData) {
            // This is where you would integrate with your Google Apps Script
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzcMdFcpQkAxIbb0iEJJfZ8fD0YgiGUetRkkw1UyMv7uY3tlza345UoL1uNrNbOUKRx/exec';
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                console.log('Success:', response);
                alert('บันทึกข้อมูลการจองรถเรียบร้อยแล้ว!');
            })
            .catch(error => {
                console.error('Error:', error);
                alert('เกิดข้อผิดพลาดในการบันทึกข้อมูล');
            });
        }
    </script>
</body>
</html>
