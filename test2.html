<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบขอจองรถใช้งาน - แผนกยานยนต์</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-light: #3b82f6;
            --secondary: #0ea5e9;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #64748b;
            --border: #e2e8f0;
            --repair: #f97316; /* สีสำหรับกำลังซ่อมแซม */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--dark);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            border-left: 6px solid var(--primary);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo {
            background: var(--primary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
        }

        h1 {
            color: var(--primary);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .subtitle {
            color: var(--gray);
            font-size: 16px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .form-container, .info-container {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            font-size: 20px;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--secondary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .required::after {
            content: " *";
            color: var(--danger);
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        input, select, textarea {
            width: 100%;
            padding: 14px 14px 14px 45px;
            border: 1px solid var(--border);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--dark);
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
            padding-left: 15px;
        }

        .car-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .car-options {
                grid-template-columns: 1fr;
            }
        }

        .car-option {
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
        }

        .car-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .car-option.selected {
            border-color: var(--primary);
            background: rgba(30, 58, 138, 0.05);
        }

        .car-option.unavailable {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .car-option.unavailable:hover {
            transform: none;
            box-shadow: none;
        }

        .car-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .car-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .car-status {
            font-size: 14px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-top: 5px;
        }

        .status-available {
            background-color: rgba(16, 185, 129, 0.15);
            color: var(--success);
        }

        .status-repair {
            background-color: rgba(249, 115, 22, 0.15);
            color: var(--repair);
        }

        .status-unavailable {
            background-color: rgba(239, 68, 68, 0.15);
            color: var(--danger);
        }

        .date-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .time-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: #f1f5f9;
        }

        .employee-info {
            background: #f8fafc;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .employee-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .info-item {
            margin-bottom: 15px;
        }

        .info-label {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .info-value {
            font-weight: 600;
            font-size: 16px;
            color: var(--dark);
        }

        .reservation-summary {
            background: #f0f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px dashed var(--border);
        }

        .summary-item:last-child {
            border-bottom: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: var(--primary);
        }

        .loading i {
            font-size: 24px;
            margin-bottom: 10px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 14px;
            padding: 20px;
        }

        .search-container {
            position: relative;
            margin-bottom: 20px;
        }

        #searchBtn {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        #searchBtn:hover {
            background: var(--primary-light);
        }

        .error-message {
            color: var(--danger);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        .input-error {
            border-color: var(--danger) !important;
        }

        .auto-complete {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            z-index: 100;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .auto-complete-item {
            padding: 10px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .auto-complete-item:hover {
            background-color: #f1f5f9;
        }

        .auto-complete-code {
            font-weight: bold;
            color: var(--primary);
        }

        .auto-complete-name {
            color: var(--dark);
        }
        
        /* สไตล์สำหรับสถานะในรายการรถ */
        .car-status-badge {
            font-size: 12px;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
            margin-left: auto;
        }
        
        .car-item {
            display: flex;
            align-items: center;
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .car-item-icon {
            font-size: 24px;
            color: var(--primary);
            margin-right: 15px;
        }
        
        .car-item-info {
            flex: 1;
        }
        
        .car-item-name {
            font-weight: 600;
            color: var(--dark);
        }
        
        .car-item-type {
            font-size: 14px;
            color: var(--gray);
        }
        
        /* สไตล์สำหรับเวลาการจอง */
        .datetime-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .datetime-group {
            display: flex;
            flex-direction: column;
        }
        
        .datetime-label {
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .time-input {
            padding-left: 40px !important;
        }
        
        .duration-display {
            margin-top: 10px;
            padding: 10px;
            background-color: #f0f9ff;
            border-radius: 8px;
            font-size: 14px;
            text-align: center;
            color: var(--primary);
            font-weight: 600;
        }
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .admin-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .btn-admin {
            padding: 12px 24px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .btn-admin:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }

        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 16px;
            width: 90%;
            max-width: 400px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .login-title {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
            font-size: 24px;
        }

        .login-input {
            width: 100%;
            padding: 14px;
            margin-bottom: 20px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
        }

        .btn-login {
            width: 100%;
            padding: 14px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-login:hover {
            background: var(--primary-light);
        }

        .car-management-container {
            display: none;
            margin-top: 20px;
        }

        .car-management-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .car-management-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 2px solid var(--border);
        }

        .car-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .car-management-name {
            font-weight: 600;
            font-size: 18px;
            color: var(--dark);
        }

        .status-select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 14px;
            margin-top: 10px;
        }

        .status-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .status-update-btn {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .status-update-btn:hover {
            background: var(--primary-light);
        }

        .status-display {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }

        .admin-only {
            display: none;
        }

        .logout-btn {
            background: var(--danger);
        }

        .logout-btn:hover {
            background: #dc2626;
        }

        .current-user {
            color: var(--primary);
            font-weight: 600;
            font-size: 14px;
        }

        
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-car"></i>
                </div>
                <div>
                    <h1>ระบบขอจองรถใช้งานบริษัท</h1>
                    <p class="subtitle">แผนกยานยนต์ - Vehicle Department</p>
                </div>
            </div>
        </header>

       <div class="login-container" id="loginContainer">
        <div class="login-box">
            <h2 class="login-title"><i class="fas fa-lock"></i> เข้าสู่ระบบผู้ดูแล</h2>
            <div class="form-group">
                <input type="text" id="adminUsername" class="login-input" placeholder="ชื่อผู้ใช้">
            </div>
            <div class="form-group">
                <input type="password" id="adminPassword" class="login-input" placeholder="รหัสผ่าน">
            </div>
            <button class="btn-login" id="loginBtn">เข้าสู่ระบบ</button>
            <div style="margin-top: 20px; text-align: center; font-size: 14px; color: var(--gray);">
                <p>ผู้ดูแลระบบเท่านั้น</p>
                <p style="font-size: 12px; margin-top: 5px;">(admin/password)</p>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- แก้ไข Header เพื่อเพิ่มปุ่มจัดการ -->
        <div class="admin-header" id="adminHeader">
            <div class="logo-container">
                <div class="logo">
                    <i class="fas fa-car"></i>
                </div>
                <div>
                    <h1>ระบบขอจองรถใช้งานบริษัท</h1>
                    <p class="subtitle">แผนกยานยนต์ - Vehicle Department</p>
                </div>
            </div>
            
            <div class="admin-controls">
                <div class="current-user" id="currentUser" style="display: none;">
                    <i class="fas fa-user"></i> <span id="usernameDisplay"></span>
                </div>
                <button class="btn-admin" id="manageCarsBtn" style="display: none;">
                    <i class="fas fa-cog"></i> จัดการสถานะรถ
                </button>
                <button class="btn-admin" id="adminLoginBtn">
                    <i class="fas fa-sign-in-alt"></i> เข้าสู่ระบบผู้ดูแล
                </button>
                <button class="btn-admin logout-btn" id="logoutBtn" style="display: none;">
                    <i class="fas fa-sign-out-alt"></i> ออกจากระบบ
                </button>
            </div>
        </div>

        <div class="main-content">
            <!-- ฟอร์มจองรถ -->
            <div class="form-container">
                <h2 class="section-title"><i class="fas fa-calendar-check"></i>แบบฟอร์มขอจองรถ</h2>
                
                <div class="search-container">
                    <div class="form-group">
                        <label for="employeeId" class="required">ค้นหาพนักงานด้วยรหัสพนักงาน</label>
                        <div class="input-with-icon">
                            <i class="fas fa-id-card"></i>
                            <input type="text" id="employeeId" placeholder="กรอกรหัสพนักงาน">
                            <div class="auto-complete" id="employeeAutoComplete"></div>
                        </div>
                        <div class="error-message" id="employeeIdError">กรุณากรอกรหัสพนักงาน</div>
                    </div>
                    <button id="searchBtn" type="button"><i class="fas fa-search"></i> ค้นหา</button>
                </div>

                <div class="employee-info" id="employeeInfo" style="display: none;">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">ข้อมูลพนักงาน</h3>
                    <div class="employee-row">
                        <div class="info-item">
                            <div class="info-label">ชื่อ-สกุล</div>
                            <div class="info-value" id="employeeName">-</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ฝ่าย</div>
                            <div class="info-value" id="employeeSection">-</div>
                        </div>     
                    </div>
                    <div class="employee-row">
                        <div class="info-item">
                            <div class="info-label">แผนก</div>
                            <div class="info-value" id="employeeDepartment">-</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">ตำแหน่ง</div>
                            <div class="info-value" id="employeePosition">-</div>
                        </div>
                    </div>
                </div>

                <form id="reservationForm">
                    <div class="form-group">
                        <label for="contact" class="required">เบอร์โทรติดต่อ</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="tel" id="contact" placeholder="กรอกเบอร์โทรติดต่อ เช่น 089-xxx-xxxx">
                        </div>
                        <div class="error-message" id="contactError">กรุณากรอกเบอร์โทรติดต่อ</div>
                    </div>

                    <div class="form-group">
                        <label for="carSelect" class="required">เลือกรถที่ต้องการจอง</label>
                        <div class="car-options" id="carOptionsContainer">
                            <!-- ตัวเลือกรถจะถูกสร้างด้วย JavaScript -->
                        </div>
                        <input type="hidden" id="carSelect" value="">
                        <div class="error-message" id="carSelectError">กรุณาเลือกรถที่ต้องการจอง</div>
                    </div>

                    <div class="form-group">
                        <label class="required">ช่วงเวลาการจอง</label>
                        
                        <!-- วันที่เริ่มจอง -->
                        <div class="date-container">
                            <div>
                                <label for="rentStartdate">วันที่เริ่มจอง</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                    <input type="date" id="rentStartdate">
                                </div>
                                <div class="error-message" id="rentStartdateError">กรุณาเลือกวันที่เริ่มจอง</div>
                            </div>
                            <div>
                                <label for="rentEnddate">วันที่สิ้นสุดการจอง</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-calendar-alt"></i>
                                    <input type="date" id="rentEnddate">
                                </div>
                                <div class="error-message" id="rentEnddateError">กรุณาเลือกวันที่สิ้นสุดการจอง</div>
                            </div>
                        </div>
                        
                        <!-- เวลาเริ่มจอง -->
                        <div class="time-container">
                            <div>
                                <label for="startTime">เวลาเริ่มต้น</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-clock"></i>
                                    <input type="time" id="startTime" class="time-input">
                                </div>
                                <div class="error-message" id="startTimeError">กรุณาเลือกเวลาเริ่มต้น</div>
                            </div>
                            <div>
                                <label for="endTime">เวลาสิ้นสุด</label>
                                <div class="input-with-icon">
                                    <i class="fas fa-clock"></i>
                                    <input type="time" id="endTime" class="time-input">
                                </div>
                                <div class="error-message" id="endTimeError">กรุณาเลือกเวลาสิ้นสุด</div>
                            </div>
                        </div>
                        
                        <!-- แสดงระยะเวลาการจอง -->
                        <div class="duration-display" id="durationDisplay">
                            ระยะเวลาการจอง: - 
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="reason" class="required">เหตุผลในการขอใช้รถ</label>
                        <div class="input-with-icon">
                            <i class="fas fa-file-alt"></i>
                            <textarea id="reason" placeholder="กรอกรายละเอียดเหตุผลในการขอใช้รถ"></textarea>
                        </div>
                        <div class="error-message" id="reasonError">กรุณากรอกเหตุผลในการขอใช้รถ</div>
                    </div>

                    <div class="loading" id="formLoading">
                        <i class="fas fa-spinner"></i>
                        <p>กำลังส่งข้อมูล กรุณารอสักครู่...</p>
                    </div>

                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> ส่งคำขอจองรถ
                        </button>
                        <button type="button" class="btn btn-secondary" id="resetBtn">
                            <i class="fas fa-redo"></i> ล้างข้อมูล
                        </button>
                    </div>
                </form>
            </div>

            <!-- ข้อมูลการจอง -->
            <div class="info-container">
                <h2 class="section-title"><i class="fas fa-info-circle"></i>ข้อมูลการจอง</h2>
                
                <div class="reservation-summary" id="reservationSummary">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">สรุปการจอง</h3>
                    <div class="summary-item">
                        <span>ชื่อผู้ขอจอง:</span>
                        <span id="summaryName">-</span>
                    </div>
                    <div class="summary-item">
                        <span>รหัสพนักงาน:</span>
                        <span id="summaryCode">-</span>
                    </div>
                    <div class="summary-item">
                        <span>ฝ่าย:</span>
                        <span id="summarySection">-</span>
                    </div>
                    <div class="summary-item">
                        <span>แผนก:</span>
                        <span id="summaryDepartment">-</span>
                    </div>
                    <div class="summary-item">
                        <span>ตำแหน่ง:</span>
                        <span id="summaryPosition">-</span>
                    </div>
                    <div class="summary-item">
                        <span>เบอร์โทรติดต่อ:</span>
                        <span id="summaryContact">-</span>
                    </div>
                    <div class="summary-item">
                        <span>รถที่เลือก:</span>
                        <span id="summaryCar">-</span>
                    </div>
                    <div class="summary-item">
                        <span>สถานะรถ:</span>
                        <span id="summaryCarStatus">-</span>
                    </div>
                    <div class="summary-item">
                        <span>วันที่เริ่มจอง:</span>
                        <span id="summaryStartDate">-</span>
                    </div>
                    <div class="summary-item">
                        <span>เวลาเริ่มต้น:</span>
                        <span id="summaryStartTime">-</span>
                    </div>
                    <div class="summary-item">
                        <span>วันที่สิ้นสุดการจอง:</span>
                        <span id="summaryEndDate">-</span>
                    </div>
                    <div class="summary-item">
                        <span>เวลาสิ้นสุด:</span>
                        <span id="summaryEndTime">-</span>
                    </div>
                    <div class="summary-item">
                        <span>ระยะเวลาการจอง:</span>
                        <span id="summaryDuration">-</span>
                    </div>
                    <div class="summary-item">
                        <span>เหตุผล:</span>
                        <span id="summaryReason" style="text-align: right;">-</span>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <h3 class="section-title"><i class="fas fa-car"></i>รายการรถทั้งหมด</h3>
                    <div class="car-list" id="carListContainer">
                        <!-- รายการรถจะถูกสร้างด้วย JavaScript -->
                    </div>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: #fef3c7; border-radius: 10px; border-left: 4px solid var(--warning);">
                    <h4 style="color: var(--dark); margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-exclamation-triangle"></i> ข้อควรระวัง
                    </h4>
                    <ul style="padding-left: 20px; color: var(--dark); font-size: 14px;">
                        <li>กรุณาตรวจสอบข้อมูลก่อนส่งคำขอจอง</li>
                        <li>การจองรถต้องทำล่วงหน้าอย่างน้อย 1 วันทำการ</li>
                        <li>กรุณานำรถคืนตามเวลาที่กำหนด</li>
                        <li>หากมีปัญหาด่วนติดต่อแผนกยานยนต์ </li>
                    </ul>
                </div>
                
               <div class="car-management-container" id="carManagementContainer">
            <div class="form-container">
                <h2 class="section-title"><i class="fas fa-tools"></i> จัดการสถานะรถทั้งหมด</h2>
                <div style="background: #f0f9ff; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                    <h4 style="color: var(--primary); margin-bottom: 10px;">คำแนะนำการใช้งาน</h4>
                    <ul style="padding-left: 20px; color: var(--dark);">
                        <li>เปลี่ยนสถานะรถตามสภาพจริง</li>
                        <li><span class="status-available" style="display: inline-block; padding: 2px 8px;">พร้อมใช้งาน</span> - รถพร้อมให้บริการ</li>
                        <li><span class="status-repair" style="display: inline-block; padding: 2px 8px;">กำลังซ่อมแซม</span> - รถอยู่ระหว่างซ่อมบำรุง</li>
                        <li><span class="status-unavailable" style="display: inline-block; padding: 2px 8px;">ไม่พร้อมใช้งาน</span> - รถไม่สามารถให้บริการได้ชั่วคราว</li>
                    </ul>
                </div>
                
                <div class="car-management-grid" id="carManagementGrid">
                    <!-- รายการรถสำหรับจัดการจะถูกสร้างด้วย JavaScript -->
                </div>
                
                <div class="button-group" style="margin-top: 30px;">
                    <button class="btn btn-primary" id="saveAllStatusBtn">
                        <i class="fas fa-save"></i> บันทึกการเปลี่ยนแปลงทั้งหมด
                    </button>
                    <button class="btn btn-secondary" id="backToMainBtn">
                        <i class="fas fa-arrow-left"></i> กลับไปหน้าหลัก
                    </button>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>ระบบขอจองรถใช้งานบริษัท - แผนกยานยนต์ | © 2026 บริษัท TokaiSolidtire จำกัด</p>
            <p>ออกแบบและพัฒนาโดย Sarawut.C</p>
            <p style="font-size: 12px; margin-top: 5px;">ใช้สำหรับภายในองค์กรเท่านั้น</p>
        </div>
    </div>

    <script>
        // ข้อมูลผู้ดูแลระบบ (ในระบบจริงควรเก็บในฐานข้อมูลที่ปลอดภัย)
        const ADMIN_ACCOUNTS = [
            { username: "admin", password: "password", name: "ผู้ดูแลระบบ" },
            { username: "vehicle", password: "vehicle123", name: "แผนกยานยนต์" },
            { username: "sarawut", password: "admin123", name: "Sarawut.C" }
        ];

        // ข้อมูลรถทั้งหมด (ใช้ตัวแปร global เดิม)
        let cars = [
            { id: 1, name: "นาวาร่า", type: "รถกระบะ", icon: "fas fa-truck-pickup", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 2, name: "รถกระบะขาว", type: "รถกระบะ", icon: "fas fa-truck-pickup", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 3, name: "x-lift No.1", type: "รถกระเช้า", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 4, name: "x-lift No.2", type: "รถกระเช้า", icon: "fas fa-truck", status: "repair", statusText: "กำลังซ่อมแซม" },
            { id: 5, name: "x-lift No.3", type: "รถกระเช้า", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 6, name: "x-lift No.4", type: "รถกระเช้า", icon: "fas fa-truck", status: "unavailable", statusText: "ไม่พร้อมใช้งาน" },
            { id: 7, name: "Fork-lift No.1", type: "รถยก", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 8, name: "Fork-lift No.2", type: "รถยก", icon: "fas fa-truck", status: "repair", statusText: "กำลังซ่อมแซม" },
            { id: 9, name: "Fork-lift No.3", type: "รถยก", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 10, name: "Fork-lift No.4", type: "รถยก", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 11, name: "Fork-lift No.5", type: "รถยก", icon: "fas fa-truck", status: "unavailable", statusText: "ไม่พร้อมใช้งาน" },
            { id: 12, name: "Fork-lift No.6", type: "รถยก", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" },
            { id: 13, name: "Fork-lift No.7", type: "รถยก", icon: "fas fa-truck", status: "repair", statusText: "กำลังซ่อมแซม" },
            { id: 14, name: "Fork-lift No.8", type: "รถยก", icon: "fas fa-truck", status: "available", statusText: "พร้อมใช้งาน" }
        ];

        // ตัวแปรเก็บข้อมูลผู้ใช้ที่ล็อกอิน
        let currentUser = null;

        // ฟังก์ชันเช็คสถานะการล็อกอินจาก localStorage
        function checkLoginStatus() {
            const savedUser = localStorage.getItem('car_reservation_admin');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUIForLoggedInUser();
            }
        }

        // ฟังก์ชันล็อกอิน
        function login(username, password) {
            const user = ADMIN_ACCOUNTS.find(acc => 
                acc.username === username && acc.password === password
            );
            
            return user;
        }

        // ฟังก์ชันล็อกเอาท์
        function logout() {
            currentUser = null;
            localStorage.removeItem('car_reservation_admin');
            updateUIForLoggedOutUser();
            Swal.fire({
                icon: 'success',
                title: 'ออกจากระบบสำเร็จ',
                text: 'คุณได้ออกจากระบบผู้ดูแลเรียบร้อยแล้ว',
                confirmButtonColor: '#1e3a8a'
            });
        }

        // อัปเดต UI สำหรับผู้ใช้ที่ล็อกอินแล้ว
        function updateUIForLoggedInUser() {
            document.getElementById('adminLoginBtn').style.display = 'none';
            document.getElementById('logoutBtn').style.display = 'flex';
            document.getElementById('manageCarsBtn').style.display = 'flex';
            document.getElementById('currentUser').style.display = 'block';
            document.getElementById('usernameDisplay').textContent = currentUser.name;
        }

        // อัปเดต UI สำหรับผู้ใช้ที่ไม่ได้ล็อกอิน
        function updateUIForLoggedOutUser() {
            document.getElementById('adminLoginBtn').style.display = 'flex';
            document.getElementById('logoutBtn').style.display = 'none';
            document.getElementById('manageCarsBtn').style.display = 'none';
            document.getElementById('currentUser').style.display = 'none';
            document.getElementById('carManagementContainer').style.display = 'none';
            document.querySelector('.main-content').style.display = 'grid';
        }

        // สร้างฟอร์มจัดการสถานะรถ
        function renderCarManagement() {
            const container = document.getElementById('carManagementGrid');
            container.innerHTML = '';
            
            cars.forEach(car => {
                const card = document.createElement('div');
                card.className = 'car-management-card';
                card.id = `car-management-${car.id}`;
                
                // กำหนดสีสถานะ
                let statusColor = 'var(--success)';
                if (car.status === "repair") statusColor = 'var(--repair)';
                if (car.status === "unavailable") statusColor = 'var(--danger)';
                
                card.innerHTML = `
                    <div class="car-management-header">
                        <div class="car-management-name">${car.name}</div>
                        <div class="status-display" style="background-color: ${statusColor}20; color: ${statusColor};">
                            ${car.statusText}
                        </div>
                    </div>
                    <div>
                        <div style="color: var(--gray); margin-bottom: 10px;">
                            <i class="${car.icon}"></i> ${car.type}
                        </div>
                        <select class="status-select" data-car-id="${car.id}">
                            <option value="available" ${car.status === 'available' ? 'selected' : ''}>พร้อมใช้งาน</option>
                            <option value="repair" ${car.status === 'repair' ? 'selected' : ''}>กำลังซ่อมแซม</option>
                            <option value="unavailable" ${car.status === 'unavailable' ? 'selected' : ''}>ไม่พร้อมใช้งาน</option>
                        </select>
                        <button class="status-update-btn" data-car-id="${car.id}">
                            <i class="fas fa-sync-alt"></i> อัปเดตสถานะ
                        </button>
                    </div>
                `;
                
                container.appendChild(card);
            });
            
            // เพิ่ม Event Listener สำหรับปุ่มอัปเดตแต่ละรถ
            document.querySelectorAll('.status-update-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const carId = parseInt(this.getAttribute('data-car-id'));
                    const selectElement = document.querySelector(`select[data-car-id="${carId}"]`);
                    updateCarStatus(carId, selectElement.value);
                });
            });
        }

        // อัปเดตสถานะรถ
        function updateCarStatus(carId, newStatus) {
            const carIndex = cars.findIndex(car => car.id === carId);
            if (carIndex === -1) return;
            
            // อัปเดตข้อมูลใน array
            cars[carIndex].status = newStatus;
            
            // อัปเดตข้อความสถานะ
            let statusText = "พร้อมใช้งาน";
            if (newStatus === "repair") statusText = "กำลังซ่อมแซม";
            if (newStatus === "unavailable") statusText = "ไม่พร้อมใช้งาน";
            
            cars[carIndex].statusText = statusText;
            
            // อัปเดตการแสดงผลในหน้าจัดการ
            const statusElement = document.querySelector(`#car-management-${carId} .status-display`);
            let statusColor = 'var(--success)';
            if (newStatus === "repair") statusColor = 'var(--repair)';
            if (newStatus === "unavailable") statusColor = 'var(--danger)';
            
            statusElement.style.backgroundColor = `${statusColor}20`;
            statusElement.style.color = statusColor;
            statusElement.textContent = statusText;
            
            // อัปเดตใน localStorage (จำลองฐานข้อมูล)
            saveCarsToStorage();
            
            // อัปเดตในหน้าจองรถ
            updateCarOptions();
            updateCarList();
            
            Swal.fire({
                icon: 'success',
                title: 'อัปเดตสถานะสำเร็จ',
                text: `อัปเดตสถานะ ${cars[carIndex].name} เป็น "${statusText}"`,
                confirmButtonColor: '#1e3a8a',
                timer: 2000,
                showConfirmButton: false
            });
        }

        // บันทึกข้อมูลรถลง localStorage
        function saveCarsToStorage() {
            localStorage.setItem('car_reservation_data', JSON.stringify(cars));
        }

        // โหลดข้อมูลรถจาก localStorage
        function loadCarsFromStorage() {
            const savedCars = localStorage.getItem('car_reservation_data');
            if (savedCars) {
                cars = JSON.parse(savedCars);
            }
        }

        // อัปเดตตัวเลือกรถในหน้าจอง
        function updateCarOptions() {
            renderCarOptions();
        }

        // อัปเดตรายการรถในหน้าจอง
        function updateCarList() {
            renderCarList();
        }

        // เมื่อ DOM โหลดเสร็จ
        document.addEventListener('DOMContentLoaded', function() {
            // โหลดข้อมูลรถจาก localStorage
            loadCarsFromStorage();
            
            // ตรวจสอบสถานะการล็อกอิน
            checkLoginStatus();
            
            // จัดการเหตุการณ์ปุ่มเข้าสู่ระบบผู้ดูแล
            document.getElementById('adminLoginBtn').addEventListener('click', function() {
                document.getElementById('loginContainer').style.display = 'flex';
            });
            
            // จัดการเหตุการณ์ปุ่มล็อกอิน
            document.getElementById('loginBtn').addEventListener('click', function() {
                const username = document.getElementById('adminUsername').value.trim();
                const password = document.getElementById('adminPassword').value.trim();
                
                if (!username || !password) {
                    Swal.fire({
                        icon: 'error',
                        title: 'ข้อมูลไม่ครบถ้วน',
                        text: 'กรุณากรอกชื่อผู้ใช้และรหัสผ่าน',
                        confirmButtonColor: '#1e3a8a'
                    });
                    return;
                }
                
                const user = login(username, password);
                
                if (user) {
                    currentUser = user;
                    localStorage.setItem('car_reservation_admin', JSON.stringify(user));
                    
                    document.getElementById('loginContainer').style.display = 'none';
                    updateUIForLoggedInUser();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'เข้าสู่ระบบสำเร็จ',
                        text: `ยินดีต้อนรับ ${user.name}`,
                        confirmButtonColor: '#1e3a8a'
                    });
                } else {
                    Swal.fire({
                        icon: 'error',
                        title: 'เข้าสู่ระบบล้มเหลว',
                        text: 'ชื่อผู้ใช้หรือรหัสผ่านไม่ถูกต้อง',
                        confirmButtonColor: '#1e3a8a'
                    });
                }
            });
            
            // จัดการเหตุการณ์ปุ่มล็อกเอาท์
            document.getElementById('logoutBtn').addEventListener('click', function() {
                Swal.fire({
                    title: 'ยืนยันการออกจากระบบ?',
                    text: 'คุณต้องการออกจากระบบผู้ดูแลหรือไม่?',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#1e3a8a',
                    cancelButtonColor: '#64748b',
                    confirmButtonText: 'ออกจากระบบ',
                    cancelButtonText: 'ยกเลิก'
                }).then((result) => {
                    if (result.isConfirmed) {
                        logout();
                    }
                });
            });
            
            // จัดการเหตุการณ์ปุ่มจัดการสถานะรถ
            document.getElementById('manageCarsBtn').addEventListener('click', function() {
                // ซ่อนหน้าหลัก
                document.querySelector('.main-content').style.display = 'none';
                // แสดงหน้าจัดการ
                document.getElementById('carManagementContainer').style.display = 'block';
                // สร้างฟอร์มจัดการ
                renderCarManagement();
            });
            
            // จัดการเหตุการณ์ปุ่มกลับไปหน้าหลัก
            document.getElementById('backToMainBtn').addEventListener('click', function() {
                document.querySelector('.main-content').style.display = 'grid';
                document.getElementById('carManagementContainer').style.display = 'none';
            });
            
            // จัดการเหตุการณ์ปุ่มบันทึกทั้งหมด
            document.getElementById('saveAllStatusBtn').addEventListener('click', function() {
                Swal.fire({
                    icon: 'success',
                    title: 'บันทึกข้อมูลสำเร็จ',
                    text: 'สถานะรถทั้งหมดถูกบันทึกเรียบร้อยแล้ว',
                    confirmButtonColor: '#1e3a8a'
                });
            });
            
            // ปิดฟอร์มล็อกอินเมื่อคลิกนอกกล่อง
            document.getElementById('loginContainer').addEventListener('click', function(e) {
                if (e.target.id === 'loginContainer') {
                    this.style.display = 'none';
                }
            });
            
            // กด Enter ในฟิลด์รหัสผ่านเพื่อล็อกอิน
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginBtn').click();
                }
            });
            
            // เริ่มต้นโค้ดเดิมทั้งหมดของคุณที่นี่...
            // (โค้ดเดิมทั้งหมดจากก่อนหน้านี้ให้วางไว้ที่นี่)
            
            // ตัวอย่างการเรียกใช้ฟังก์ชันหลักๆ จากโค้ดเดิม
            // ให้เรียกใช้ฟังก์ชันจากโค้ดเดิมที่นี่
            // เช่น fetchEmployees(), renderCarOptions(), renderCarList() ฯลฯ
            
        });
    </script>
</body>
</html>
