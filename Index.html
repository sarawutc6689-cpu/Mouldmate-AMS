<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ระบบขอจองรถใช้งาน</title>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<style>
body{
  font-family: 'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#e0f2fe,#f8fafc);
  padding:20px;
}
.container{
  max-width:900px;
  margin:auto;
  background:#fff;
  padding:30px;
  border-radius:18px;
  box-shadow:0 15px 30px rgba(0,0,0,.1);
}
h1{
  color:#1e3a8a;
  text-align:center;
  margin-bottom:25px;
}
label{font-weight:600;margin-top:15px;display:block;}
input,textarea{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid #e2e8f0;
  margin-top:6px;
}
.car-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:15px;
  margin-top:10px;
}
.car{
  border:2px solid #e2e8f0;
  border-radius:14px;
  padding:20px;
  text-align:center;
  cursor:pointer;
}
.car.selected{
  border-color:#2563eb;
  background:#eff6ff;
}
button{
  margin-top:25px;
  width:100%;
  padding:14px;
  font-size:16px;
  border:none;
  border-radius:12px;
  background:#1e3a8a;
  color:white;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="container">
<h1><i class="fas fa-car"></i> ระบบขอจองรถใช้งานบริษัท</h1>

<label>รหัสพนักงาน</label>
<input id="code" placeholder="เช่น 1001">

<div id="empInfo" style="margin-top:10px;color:#334155"></div>

<label>เบอร์โทรติดต่อ *</label>
<input id="contact">

<label>เลือกรถ</label>
<div class="car-grid" id="cars"></div>

<label>วันที่เริ่มจอง</label>
<input type="date" id="start">

<label>วันที่สิ้นสุด</label>
<input type="date" id="end">

<label>เหตุผล</label>
<textarea id="reason"></textarea>

<button onclick="submitForm()">ส่งคำขอ</button>
</div>

<script>
let employees=[], selectedCar='';

google.script.run.withSuccessHandler(d=>employees=d).getEmployees();

const carList=["นาวาร่า","x-lift No.1","x-lift No.2","x-lift No.3","x-lift No.4"];
const carBox=document.getElementById('cars');

carList.forEach(c=>{
  const div=document.createElement('div');
  div.className='car';
  div.innerHTML=`<i class="fas fa-truck"></i><br>${c}`;
  div.onclick=()=>{
    document.querySelectorAll('.car').forEach(x=>x.classList.remove('selected'));
    div.classList.add('selected');
    selectedCar=c;
  }
  carBox.appendChild(div);
});

document.getElementById('code').addEventListener('input',()=>{
  const emp=employees.find(e=>e.code==code.value);
  empInfo.innerHTML= emp ?
   `ชื่อ: ${emp.name}<br>ฝ่าย: ${emp.section}<br>แผนก: ${emp.department}<br>ตำแหน่ง: ${emp.position}` : '';
});

function submitForm(){
  const emp=employees.find(e=>e.code==code.value);
  if(!emp || !contact.value || !selectedCar){
    Swal.fire('ข้อมูลไม่ครบ','','error'); return;
  }

  google.script.run.withSuccessHandler(()=>{
    Swal.fire('บันทึกสำเร็จ','','success');
  }).saveReservation({
    ...emp,
    contact:contact.value,
    choose:selectedCar,
    rentStartdate:start.value,
    rentEnddate:end.value,
    reason:reason.value
  });
}
</script>
</body>
</html>
